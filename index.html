<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Jin Songs Sorter</title>
<style>
body {
    margin: 0;
    padding: 20px;
    font-family: Arial, sans-serif;
    background: #f2e6ff;
    color: #2a0a3e;
    display: flex;
    flex-direction: column;
    align-items: center;
}
h1 {
    color: #5c2a9d;
    margin-bottom: 5px;
    text-align: center;
}
.subtitle {
    font-size: 16px;
    color: #8e63c7;
    margin-bottom: 20px;
    text-align: center;
}
.subtitle a {
    color: #a678e5;
    text-decoration: none;
}
.subtitle a:hover {
    color: #5c2a9d;
}
.instructions {
    font-size: 16px;
    margin: 10px auto 20px auto;
    color: #3d1a60;
    text-align: center;
    max-width: 600px;
}
#battleNumber {
    font-weight: bold;
    font-size: 18px;
    margin-bottom: 20px;
    color: #4a1f8a;
    text-align: center;
}

/* FLEX LAYOUT FOR BATTLE ROW */
.battleRow {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    width: 100%;
    max-width: 650px;
    gap: 10px;
}
.optionCell {
    flex: 1 1 48%;
    min-height: 100px;
    border-radius: 12px;
    border: 2px solid #5c2a9d;
    background: #e0c9ff;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 10px;
    text-align: center;
    word-wrap: break-word;
    transition: all 0.2s ease;
}
.optionCell:hover {
    background: #d1b3ff;
    transform: scale(1.03);
}

.middleGroup {
    display: flex;
    justify-content: center;
    gap: 15px;
    width: 100%;
    margin-top: 10px;
}
.middleCell {
    flex: 1 1 45%;
    min-height: 80px;
    border-radius: 12px;
    border: 2px solid #5c2a9d;
    background: #f0e0ff;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 10px;
    font-size: 14px;
    color: #5c2a9d;
    transition: all 0.2s ease;
    text-align: center;
}
.middleCell:hover {
    background: #e0c0ff;
    transform: scale(1.05);
}

/* RESULTS AND FOOTER */
#resultField table {
    border-collapse: collapse;
    margin: 20px auto;
}
#resultField td, #resultField th {
    border: 1px solid #5c2a9d;
    padding: 5px 10px;
}
#resultField th {
    background-color: #8e63c7;
    color: #fff;
}
.footer {
    margin-top: 30px;
    font-size: 14px;
    color: #5c2a9d;
    text-align: center;
}
.footer a {
    color: #a678e5;
    text-decoration: none;
}
.footer a:hover {
    color: #5c2a9d;
}

/* MOBILE RESPONSIVE */
@media (max-width: 480px) {
    .battleRow {
        flex-direction: column;
        gap: 10px;
    }
    .optionCell, .middleCell {
        flex: 1 1 90%;
    }
    .middleGroup {
        flex-direction: column;
        gap: 10px;
    }
}
</style>
</head>
<body>

<h1>Jin Songs Sorter</h1>
<p class="subtitle">by <strong>JinTracksDaily</strong> | <a href="https://twitter.com/jindailytracks" target="_blank">X / Twitter</a></p>

<p class="instructions">
Pick which song you like better in each battle to get an accurate list of your favorite songs.<br>
Note: hitting 'no opinion' or 'I like both' frequently will negatively affect your results.
</p>

<div id="battleNumber">battle #1<br>0% sorted.</div>

<!-- BATTLE ROW -->
<div class="battleRow">
    <div id="leftField" class="optionCell"></div>
    <div id="rightField" class="optionCell"></div>
</div>

<!-- MIDDLE OPTIONS -->
<div class="middleGroup">
    <div id="middleI" class="middleCell">I like both</div>
    <div id="middleN" class="middleCell">no opinion</div>
</div>

<div id="resultField"></div>

<p class="footer">Used with permission. Created by <a href="http://biasorter.tumblr.com" target="_blank">Biasorter</a></p>

<script>
// Songs array
var namMember = [
"Awake","Epiphany","Abyss","Tonight","Yours","Close To You","Super Tuna",
"Running Wild","I'll Be There","Another Level","Falling","Falling ft. Taka",
"Heart On The Window ft. WENDY","I will come to you","Don't Say You Love Me",
"Nothing Without Your Love","Loser ft. YENA","Rope It","Background",
"With The Clouds","To Me, Today","The Astronaut","Moon","It's Definitely You with V"
];

// Sorter variables
var lstMember = [], parent = [], equal = [], rec = [], cmp1, cmp2, head1, head2, nrec;
var numQuestion, totalSize, finishSize, finishFlag;

// Initialization
function initList() {
    var n = 0, mid, i;
    lstMember[n] = [];
    for(i=0;i<namMember.length;i++) lstMember[n][i]=i;
    parent[n] = -1;
    totalSize=0; n++;
    for(i=0;i<lstMember.length;i++){
        if(lstMember[i].length>=2){
            mid=Math.ceil(lstMember[i].length/2);
            lstMember[n]=lstMember[i].slice(0,mid); totalSize+=lstMember[n].length; parent[n]=i; n++;
            lstMember[n]=lstMember[i].slice(mid,lstMember[i].length); totalSize+=lstMember[n].length; parent[n]=i; n++;
        }
    }
    for(i=0;i<namMember.length;i++) rec[i]=0;
    nrec=0;
    for(i=0;i<=namMember.length;i++) equal[i]=-1;
    cmp1=lstMember.length-2; cmp2=lstMember.length-1; head1=head2=0;
    numQuestion=1; finishSize=0; finishFlag=0;
}

// Sorting logic
function sortList(flag){
    var i,str;
    if(flag<0){ rec[nrec]=lstMember[cmp1][head1]; head1++; nrec++; finishSize++;
        while(equal[rec[nrec-1]]!=-1){ rec[nrec]=lstMember[cmp1][head1]; head1++; nrec++; finishSize++; }
    }
    else if(flag>0){ rec[nrec]=lstMember[cmp2][head2]; head2++; nrec++; finishSize++;
        while(equal[rec[nrec-1]]!=-1){ rec[nrec]=lstMember[cmp2][head2]; head2++; nrec++; finishSize++; }
    }
    else {
        rec[nrec]=lstMember[cmp1][head1]; head1++; nrec++; finishSize++;
        while(equal[rec[nrec-1]]!=-1){ rec[nrec]=lstMember[cmp1][head1]; head1++; nrec++; finishSize++; }
        equal[rec[nrec-1]]=lstMember[cmp2][head2];
        rec[nrec]=lstMember[cmp2][head2]; head2++; nrec++; finishSize++;
        while(equal[rec[nrec-1]]!=-1){ rec[nrec]=lstMember[cmp2][head2]; head2++; nrec++; finishSize++; }
    }
    if(head1<lstMember[cmp1].length && head2==lstMember[cmp2].length){
        while(head1<lstMember[cmp1].length){ rec[nrec]=lstMember[cmp1][head1]; head1++; nrec++; finishSize++; }
    } else if(head1==lstMember[cmp1].length && head2<lstMember[cmp2].length){
        while(head2<lstMember[cmp2].length){ rec[nrec]=lstMember[cmp2][head2]; head2++; nrec++; finishSize++; }
    }
    if(head1==lstMember[cmp1].length && head2==lstMember[cmp2].length){
        for(i=0;i<lstMember[cmp1].length+lstMember[cmp2].length;i++){
            lstMember[parent[cmp1]][i]=rec[i];
        }
        lstMember.pop(); lstMember.pop(); cmp1-=2; cmp2-=2; head1=head2=0;
        if(head1==0 && head2==0){ for(i=0;i<namMember.length;i++) rec[i]=0; nrec=0; }
    }
    if(cmp1<0){ str="battle #"+(numQuestion-1)+"<br>"+Math.floor(finishSize*100/totalSize)+"% sorted."; 
        document.getElementById("battleNumber").innerHTML=str; showResult(); finishFlag=1; }
    else{ showImage(); }
}

// Show battle options
function showImage(){
    var str0="battle #"+numQuestion+"<br>"+Math.floor(finishSize*100/totalSize)+"% sorted.";
    var str1=""+namMember[lstMember[cmp1][head1]];
    var str2=""+namMember[lstMember[cmp2][head2]];
    document.getElementById("battleNumber").innerHTML=str0;
    document.getElementById("leftField").innerHTML=str1;
    document.getElementById("rightField").innerHTML=str2;
    numQuestion++;
}

// Show final results
function showResult(){
    var ranking=1, sameRank=1, str="", i;
    str += "<table style='width:200px; font-size:18px; line-height:120%; margin-left:auto; margin-right:auto; border:1px solid #5c2a9d; border-collapse:collapse' align='center'>";
    str += "<tr><th>rank</th><th>options</th></tr>";
    for(i=0;i<namMember.length;i++){
        str += "<tr><td style='border:1px solid #5c2a9d; text-align:center; padding:5px;'>"+ranking+"</td><td style='border:1px solid #5c2a9d; padding-left:5px;'>"+namMember[lstMember[0][i]]+"</td></tr>";
        if(i<namMember.length-1){
            if(equal[lstMember[0][i]]==lstMember[0][i+1]) sameRank++;
            else { ranking+=sameRank; sameRank=1; }
        }
    }
    str += "</table>";
    document.getElementById("resultField").innerHTML=str;
}

// Connect buttons
document.getElementById('leftField').onclick = function(){ if(!finishFlag) sortList(-1); };
document.getElementById('rightField').onclick = function(){ if(!finishFlag) sortList(1); };
document.getElementById('middleI').onclick = function(){ if(!finishFlag) sortList(0); };
document.getElementById('middleN').onclick = function(){ if(!finishFlag) sortList(0); };

// Initialize
window.addEventListener('DOMContentLoaded', function(){
    initList();
    showImage();
});
</script>

</body>
</html>
