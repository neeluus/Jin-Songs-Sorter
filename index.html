<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Jin Songs Sorter</title>
<style>
    body {
        width: 600px;
        margin: 0 auto;
        font-family: 'Times New Roman', serif;
        text-align: center;
        background-color: #ffffff;
        color: #000000;
    }
    #mainTable {
        font-size: 19px;
        font-family: 'Times New Roman', serif;
        text-align: center;
        vertical-align: middle;
        width: 410px;
        margin-left: auto;
        margin-right: auto;
        border-collapse: separate;
        border-spacing: 10px 5px;
    }
    #leftField, #rightField {
        width: 120px;
        height: 150px;
        border: 1px solid #000;
        cursor: pointer;
    }
    .middleField {
        width: 120px;
        height: 70px;
        border: 1px solid #000;
        cursor: pointer;
    }
    a {
        color: #e097d9;
        text-decoration: none;
    }
    a:hover {
        color: #8f8f8f;
    }
    #footer {
        text-align:center;
        margin-top: 30px;
        font-size:14px;
        color:#555;
    }
</style>
</head>
<body>

<h1>Jin Songs Sorter</h1>
<p style="font-size:16px; margin-top:-10px;">by <strong>JinTracksDaily</strong></p>

<p class="instructions">
Pick which song you like better in each battle to get an accurate list of your favorite songs.<br>
Note: hitting 'no opinion' or 'I like both' frequently will negatively affect your results.
</p>

<table id="mainTable">
<tbody>
<tr>
<td id="battleNumber" colspan="3" style="padding-bottom: 10px;"><b>battle #1<br>0% sorted.</b></td>
</tr>
<tr>
<td id="leftField" onclick="if(finishFlag==0) sortList(-1);" rowspan="2"></td>
<td class="middleField" onclick="if(finishFlag==0) sortList(0);">I like both</td>
<td id="rightField" onclick="if(finishFlag==0) sortList(1);" rowspan="2"></td>
</tr>
<tr>
<td class="middleField" onclick="if(finishFlag==0) sortList(0);">no opinion</td>
</tr>
</tbody>
</table>

<div id="resultField" style="text-align:center; margin-top:20px;"></div>

<!-- Footer -->
<div id="footer">
    <p>used with permission. created by <a href="http://biasorter.tumblr.com/" target="_blank">Biasorter</a></p>
    <p>by <strong>JinTracksDaily</strong> | Follow me on 
        <a href="https://twitter.com/jindailytracks" target="_blank">X / Twitter</a>
    </p>
</div>

<script>
// Songs array
var namMember = [
"Awake","Epiphany","Abyss","Tonight","Yours","Close To You","Super Tuna",
"Running Wild","I'll Be There","Another Level","Falling","Falling ft. Taka",
"Heart On The Window ft. WENDY","I will come to you","Don't Say You Love Me",
"Nothing Without Your Love","Loser ft. YENA","Rope It","Background",
"With The Clouds","To Me, Today","The Astronaut","Moon","It's Definitely You with V"
];

// Sorter logic
var lstMember = [], parent = [], equal = [], rec = [], cmp1, cmp2, head1, head2, nrec;
var numQuestion, totalSize, finishSize, finishFlag;

function initList() {
    var n = 0, mid, i;
    lstMember[n] = [];
    for(i=0;i<namMember.length;i++) lstMember[n][i]=i;
    parent[n] = -1;
    totalSize=0; n++;
    for(i=0;i<lstMember.length;i++){
        if(lstMember[i].length>=2){
            mid=Math.ceil(lstMember[i].length/2);
            lstMember[n]=lstMember[i].slice(0,mid); totalSize+=lstMember[n].length; parent[n]=i; n++;
            lstMember[n]=lstMember[i].slice(mid,lstMember[i].length); totalSize+=lstMember[n].length; parent[n]=i; n++;
        }
    }
    for(i=0;i<namMember.length;i++) rec[i]=0;
    nrec=0;
    for(i=0;i<=namMember.length;i++) equal[i]=-1;
    cmp1=lstMember.length-2; cmp2=lstMember.length-1; head1=head2=0;
    numQuestion=1; finishSize=0; finishFlag=0;
}

function sortList(flag){
    var i,str;
    if(flag<0){ rec[nrec]=lstMember[cmp1][head1]; head1++; nrec++; finishSize++;
        while(equal[rec[nrec-1]]!=-1){ rec[nrec]=lstMember[cmp1][head1]; head1++; nrec++; finishSize++; }
    }
    else if(flag>0){ rec[nrec]=lstMember[cmp2][head2]; head2++; nrec++; finishSize++;
        while(equal[rec[nrec-1]]!=-1){ rec[nrec]=lstMember[cmp2][head2]; head2++; nrec++; finishSize++; }
    }
    else {
        rec[nrec]=lstMember[cmp1][head1]; head1++; nrec++; finishSize++;
        while(equal[rec[nrec-1]]!=-1){ rec[nrec]=lstMember[cmp1][head1]; head1++; nrec++; finishSize++; }
        equal[rec[nrec-1]]=lstMember[cmp2][head2];
        rec[nrec]=lstMember[cmp2][head2]; head2++; nrec++; finishSize++;
        while(equal[rec[nrec-1]]!=-1){ rec[nrec]=lstMember[cmp2][head2]; head2++; nrec++; finishSize++; }
    }
    if(head1<lstMember[cmp1].length && head2==lstMember[cmp2].length){
        while(head1<lstMember[cmp1].length){ rec[nrec]=lstMember[cmp1][head1]; head1++; nrec++; finishSize++; }
    } else if(head1==lstMember[cmp1].length && head2<lstMember[cmp2].length){
        while(head2<lstMember[cmp2].length){ rec[nrec]=lstMember[cmp2][head2]; head2++; nrec++; finishSize++; }
    }
    if(head1==lstMember[cmp1].length && head2==lstMember[cmp2].length){
        for(i=0;i<lstMember[cmp1].length+lstMember[cmp2].length;i++){
            lstMember[parent[cmp1]][i]=rec[i];
        }
        lstMember.pop(); lstMember.pop(); cmp1-=2; cmp2-=2; head1=head2=0;
        if(head1==0 && head2==0){ for(i=0;i<namMember.length;i++) rec[i]=0; nrec=0; }
    }
    if(cmp1<0){ str="battle #"+(numQuestion-1)+"<br>"+Math.floor(finishSize*100/totalSize)+"% sorted."; 
        document.getElementById("battleNumber").innerHTML=str; showResult(); finishFlag=1; }
    else{ showImage(); }
}

function showResult(){
    var ranking=1, sameRank=1, str="", i;
    str += "<table style='width:200px; font-size:18px; line-height:120%; margin-left:auto; margin-right:auto; border:1px solid #000; border-collapse:collapse' align='center'>";
    str += "<tr><td style='color:#fff; background-color:#e097d9; text-align:center;'>rank</td><td style='color:#fff; background-color:#e097d9; text-align:center;'>options</td></tr>";
    for(i=0;i<namMember.length;i++){
        str += "<tr><td style='border:1px solid #000; text-align:center; padding-right:5px;'>"+ranking+"</td><td style='border:1px solid #000; padding-left:5px;'>"+namMember[lstMember[0][i]]+"</td></tr>";
        if(i<namMember.length-1){
            if(equal[lstMember[0][i]]==lstMember[0][i+1]) sameRank++;
            else { ranking+=sameRank; sameRank=1; }
        }
    }
    str += "</table>";
    document.getElementById("resultField").innerHTML=str;
}

function showImage(){
    var str0="battle #"+numQuestion+"<br>"+Math.floor(finishSize*100/totalSize)+"% sorted.";
    var str1=""+namMember[lstMember[cmp1][head1]];
    var str2=""+namMember[lstMember[cmp2][head2]];
    document.getElementById("battleNumber").innerHTML=str0;
    document.getElementById("leftField").innerHTML=str1;
    document.getElementById("rightField").innerHTML=str2;
    numQuestion++;
}

// Initialize sorter
initList();
showImage();
</script>

</body>
</html>
